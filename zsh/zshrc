#
# Settings for interactive shells
#

#
# ZSH Options (man zshoptions)
# Use `setopt` to see which options are set different from the ZSH defaults.
# Use `set -o` to see all options.
#

#setopt interactive_comments

#
# Aliases
#

# Moving around directories a bit easier
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias .....="cd ../../../.."

# IP addresses
alias ip="dig +short myip.opendns.com @resolver1.opendns.com"
alias localip="ipconfig getifaddr en0"
alias ips="ifconfig -a | grep -o 'inet6\? \(addr:\)\?\s\?\(\(\([0-9]\+\.\)\{3\}[0-9]\+\)\|[a-fA-F0-9:]\+\)' | awk '{ sub(/inet6? (addr:)? ?/, \"\"); print }'"

# Hide/show all desktop icons (useful when presenting)
alias hidedesktop="defaults write com.apple.finder CreateDesktop -bool false && killall Finder"
alias showdesktop="defaults write com.apple.finder CreateDesktop -bool true && killall Finder"

# URL-encode strings
alias urlencode='python -c "import sys, urllib as ul; print ul.quote_plus(sys.argv[1]);"'

# Print each PATH entry on a separate line
alias path='echo -e ${PATH//:/\\n}'

#
# Homebrew completions support
# See: https://docs.brew.sh/Shell-Completion#configuring-completions-in-zsh
#
# This will put many completion functions on the $fpath. These completion functions need to be in scope when later
# compinit is called (in the ZSH plugins).
#
if type brew &>/dev/null
then
  FPATH="$(brew --prefix)/share/zsh/site-functions:${FPATH}"
fi

#
# Antidote - ZSH plugin manager
#
source ${HOME}/.dotfiles/zsh/antidote/antidote.zsh
# Statically load plugins listed in ./zsh_plugins
antidote load ${HOME}/.dotfiles/zsh/zsh_plugins

#
# Completion system styles (preferences)
# More info: `man zshcompsys` (search for "Standard Styles")
#
# These are set after compinit is called.
# Use `zstyle -L ':completion:*'` to see which completion styles are already set for the completion system.
#

# TODO: case insensitive completion for files and folder names (but still insert the right capitalization)

# Add completing strategies. The default is `_complete _ignored`
zstyle ':completion:*' completer _extensions _complete _match _prefix _ignored _correct _approximate

# Allow you to select completions from a menu (highlight current completion, naviagte with arrow keys, etc)
zstyle ':completion:*' menu select

# Autocomplete options for cd (and related functions) instead of directory stack. I don't really use directory stacks
# so showing completion for options/flags is more useful.
zstyle ':completion:*' complete-options true
# When completing with filenames, show the most recently modified files first
zstyle ':completion:*' file-sort modification

# Completions for commands like `kill`. This allows it to find way more running processes, including those from full
# macOS apps. I'm not 100% certain what this command can do that the default is not doing. The default, according to
# the ZSH docs, will also run `ps` to find the list of processes.
zstyle ':completion:*:*:*:*:processes' command "ps -u $USERNAME -o pid,user,comm -w -w"
# Colorize the completions for `kill`
zstyle ':completion:*:*:kill:*:processes' list-colors '=(#b) #([0-9]#) ([0-9a-z-]#)*=01;34=0=01'

# Translation of the BSD-based LSCOLORS default to the GNU/Linux-based LS_COLORS
# https://geoff.greer.fm/lscolors/
LS_COLORS='di=34:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43'
# Colors for files and directory
zstyle ':completion:*:*:*:*:default' list-colors ${(s.:.)LS_COLORS}

# Only display some tags for the command cd (exclude named-directories).
# This seems like a good idea, although I don't see myself creating any named directories.
zstyle ':completion:*:*:cd:*' tag-order local-directories directory-stack path-directories

# Group completions by tag (such as files, arguments, builtins, commands, etc)
zstyle ':completion:*' group-name ''

# Get some debugging messages out of the completion system
zstyle ':completion:*:*:*:*:corrections' format '%F{yellow}!- %d (errors: %e) -!%f'
zstyle ':completion:*:*:*:*:descriptions' format '%F{blue}-- %d --%f'
zstyle ':completion:*:*:*:*:messages' format ' %F{purple} -- %d --%f'
zstyle ':completion:*:*:*:*:warnings' format ' %F{red}-- no matches found --%f'

#
# Pure prompt (https://github.com/sindresorhus/pure)
#
autoload -U promptinit; promptinit
# ... any pure customization goes here ...
prompt pure
